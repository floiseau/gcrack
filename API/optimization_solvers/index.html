
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://floiseau.github.io/gcrack/API/optimization_solvers/">
      
      
        <link rel="prev" href="../models/">
      
      
        <link rel="next" href="../postprocess/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Optimization solvers - gcrack : Linear Elastic Fracture Mechanic solver</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gcrack.optimization_solvers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="gcrack : Linear Elastic Fracture Mechanic solver" class="md-header__button md-logo" aria-label="gcrack : Linear Elastic Fracture Mechanic solver" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gcrack : Linear Elastic Fracture Mechanic solver
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Optimization solvers
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/floiseau/gcrack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    floiseau/gcrack
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="gcrack : Linear Elastic Fracture Mechanic solver" class="md-nav__button md-logo" aria-label="gcrack : Linear Elastic Fracture Mechanic solver" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gcrack : Linear Elastic Fracture Mechanic solver
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/floiseau/gcrack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    floiseau/gcrack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LEFM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LEFM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SIF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SIF
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../boundary_conditions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Boundary conditions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Domain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exporters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exporters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gcrack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gcrack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Optimization solvers
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimization solvers
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers" class="md-nav__link">
    <span class="md-ellipsis">
      
        optimization_solvers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver" class="md-nav__link">
    <span class="md-ellipsis">
      
        LoadFactorSolver
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoadFactorSolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.export_minimization_plots" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_minimization_plots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.objective" class="md-nav__link">
    <span class="md-ellipsis">
      
        objective
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.objective_pert" class="md-nav__link">
    <span class="md-ellipsis">
      
        objective_pert
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.solve" class="md-nav__link">
    <span class="md-ellipsis">
      
        solve
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.gradient_descent_with_line_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        gradient_descent_with_line_search
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postprocess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Postprocess
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Solvers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/expression_parsers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Expression parsers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/williams_series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Williams series
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers" class="md-nav__link">
    <span class="md-ellipsis">
      
        optimization_solvers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver" class="md-nav__link">
    <span class="md-ellipsis">
      
        LoadFactorSolver
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoadFactorSolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.export_minimization_plots" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_minimization_plots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.objective" class="md-nav__link">
    <span class="md-ellipsis">
      
        objective
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.objective_pert" class="md-nav__link">
    <span class="md-ellipsis">
      
        objective_pert
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.LoadFactorSolver.solve" class="md-nav__link">
    <span class="md-ellipsis">
      
        solve
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gcrack.optimization_solvers.gradient_descent_with_line_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        gradient_descent_with_line_search
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Optimization solvers</h1>

<div class="doc doc-object doc-module">



<a id="gcrack.optimization_solvers"></a>
    <div class="doc doc-contents first">

        <p>Module for solving the optimization problem to determine the load factor in crack propagation simulations.</p>
<p>This module provides the <code>LoadFactorSolver</code> class, which implements the GMERR (Generalized Maximum Energy Release Rate) criterion for crack propagation.
The solver is based on the work of Amestoy and Leblond (1992) and is designed to work with the <code>gcrack.lefm</code> module.
It uses gradient descent with line search to find the optimal crack propagation angle and load factor.</p>
<p>The module also includes a custom gradient descent optimizer with line search for robust convergence, even in the presence of discontinuities or "cups" in critical energy release rate Gc.</p>


<details class="references" open>
  <summary>References</summary>
  <p>Amestoy, M., &amp; Leblond, J. B. (1992). A new numerical method for crack growth prediction.
International Journal of Solids and Structures, 29(21), 2619-2638.
https://doi.org/10.1016/0020-7683(92)90210-K</p>
</details>









<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="gcrack.optimization_solvers.LoadFactorSolver" class="doc doc-heading">
            <code>LoadFactorSolver</code>


</h2>


    <div class="doc doc-contents ">



        <p>Solver for load factors and crack propagation angles using the GMERR criterion.</p>
<p>This class implements the GMERR (Generalized Maximum Energy Release Rate) criterion for crack propagation.
It uses automatic differentiation to compute gradients and Hessians of the objective function, and employs gradient descent with line search to find the optimal crack propagation angle and load factor.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="gcrack.optimization_solvers.LoadFactorSolver.model">model</span></code></td>
            <td>
                  <code><span title="gcrack.gcrack.models.ElasticModel">ElasticModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elastic model used for the simulation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="gcrack.optimization_solvers.LoadFactorSolver.Gc">Gc</span></code></td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The critical energy release rate function.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="gcrack.optimization_solvers.LoadFactorSolver.grad">grad</span></code></td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The gradient of the objective function.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="gcrack.optimization_solvers.LoadFactorSolver.hess">hess</span></code></td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Hessian of the objective function.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="gcrack.optimization_solvers.LoadFactorSolver.grad_pert">grad_pert</span></code></td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The gradient of the perturbed objective function.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="gcrack.optimization_solvers.LoadFactorSolver.hess_pert">hess_pert</span></code></td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Hessian of the perturbed objective function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LoadFactorSolver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solver for load factors and crack propagation angles using the GMERR criterion.</span>

<span class="sd">    This class implements the GMERR (Generalized Maximum Energy Release Rate) criterion for crack propagation.</span>
<span class="sd">    It uses automatic differentiation to compute gradients and Hessians of the objective function, and employs gradient descent with line search to find the optimal crack propagation angle and load factor.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        model (gcrack.models.ElasticModel): The elastic model used for the simulation.</span>
<span class="sd">        Gc (Callable): The critical energy release rate function.</span>
<span class="sd">        grad (Callable): The gradient of the objective function.</span>
<span class="sd">        hess (Callable): The Hessian of the objective function.</span>
<span class="sd">        grad_pert (Callable): The gradient of the perturbed objective function.</span>
<span class="sd">        hess_pert (Callable): The Hessian of the perturbed objective function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">ElasticModel</span><span class="p">,</span> <span class="n">Gc_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">xc</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the LoadFactorSolver.</span>

<span class="sd">        Args:</span>
<span class="sd">            model (gcrack.models.ElasticModel): The elastic model used for the simulation.</span>
<span class="sd">            Gc_func (Callable): The critical energy release rate function.</span>
<span class="sd">            xc (List): Position of the crack tip.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Store the model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="c1"># Store the crack tip position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span>
        <span class="c1"># Set the critical energy release rate function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Gc</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">Gc_func</span><span class="p">)</span>
        <span class="c1"># Automatic differentiation of the objective function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hess</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">hessian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">))</span>
        <span class="c1"># Automatic differentiation of the perturbed objective function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_pert</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_pert</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hess_pert</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">hessian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_pert</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">Ep</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">Tp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the objective function for the GMERR criterion.</span>

<span class="sd">        This function computes the objective function for the GMERR criterion, which is used to find the optimal crack propagation angle and load factor.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (jnp.ndarray): The optimization variables (crack propagation angle).</span>
<span class="sd">            Ep (float): Plane strain modulus.</span>
<span class="sd">            s (float): Internal length associated with T-stress.</span>
<span class="sd">            KIc (float): Mode I stress intensity factor for the controlled problem.</span>
<span class="sd">            KIIc (float): Mode II stress intensity factor for the controlled problem.</span>
<span class="sd">            Tc (float): T-stress for the controlled problem.</span>
<span class="sd">            KIp (float): Mode I stress intensity factor for the prescribed problem.</span>
<span class="sd">            KIIp (float): Mode II stress intensity factor for the prescribed problem.</span>
<span class="sd">            Tp (float): T-stress for the prescribed problem.</span>
<span class="sd">            phi0 (float): Initial crack angle.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The value of the objective function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: The KIc (etc.) means controlled (not critical!)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Compute the G star</span>
        <span class="n">Gs_cc</span> <span class="o">=</span> <span class="n">G_star</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">Gs_cp</span> <span class="o">=</span> <span class="n">G_star_coupled</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">Gs_pp</span> <span class="o">=</span> <span class="n">G_star</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="c1"># Compute the Gc from phi</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gc</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="c1"># Compute and return the load factor</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">Gs_cp</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">Gs_cc</span> <span class="o">*</span> <span class="p">(</span><span class="n">Gs_pp</span> <span class="o">-</span> <span class="n">gc</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">Gs_cp</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Gs_cc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">objective_pert</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">Ep</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">KIIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">Tp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the perturbed objective function for the GMERR criterion.</span>

<span class="sd">        This function adds a small perturbation to the objective function to avoid</span>
<span class="sd">        convergence to a maximum instead of a minimum.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (jnp.ndarray): The optimization variables (crack propagation angle).</span>
<span class="sd">            Ep (float): Plane strain modulus.</span>
<span class="sd">            s (float): Internal length associated with T-stress.</span>
<span class="sd">            KIc (float): Mode I stress intensity factor for the controlled problem.</span>
<span class="sd">            KIIc (float): Mode II stress intensity factor for the controlled problem.</span>
<span class="sd">            Tc (float): T-stress for the controlled problem.</span>
<span class="sd">            KIp (float): Mode I stress intensity factor for the prescribed problem.</span>
<span class="sd">            KIIp (float): Mode II stress intensity factor for the prescribed problem.</span>
<span class="sd">            Tp (float): T-stress for the prescribed problem.</span>
<span class="sd">            phi0 (float): Initial crack angle.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The value of the perturbed objective function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">phi0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">SIFs_controlled</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">SIFs_prescribed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Solves for the optimal crack propagation angle and load factor.</span>

<span class="sd">        This function uses gradient descent with line search to find the optimal</span>
<span class="sd">        crack propagation angle and load factor.</span>

<span class="sd">        Args:</span>
<span class="sd">            phi0 (float): Initial crack angle.</span>
<span class="sd">            SIFs_controlled (dict): Stress intensity factors for the controlled problem.</span>
<span class="sd">            SIFs_prescribed (dict): Stress intensity factors for the prescribed problem.</span>
<span class="sd">            s (float): Internal length associated with T-stress.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[float, float]: The optimal crack propagation angle and load factor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
            <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
            <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
            <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
            <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="c1"># Perform the minimization</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Ep&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Ep_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">),</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span>
            <span class="s2">&quot;KIc&quot;</span><span class="p">:</span> <span class="n">KIc</span><span class="p">,</span>
            <span class="s2">&quot;KIIc&quot;</span><span class="p">:</span> <span class="n">KIIc</span><span class="p">,</span>
            <span class="s2">&quot;Tc&quot;</span><span class="p">:</span> <span class="n">Tc</span><span class="p">,</span>
            <span class="s2">&quot;KIp&quot;</span><span class="p">:</span> <span class="n">KIp</span><span class="p">,</span>
            <span class="s2">&quot;KIIp&quot;</span><span class="p">:</span> <span class="n">KIIp</span><span class="p">,</span>
            <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">Tp</span><span class="p">,</span>
            <span class="s2">&quot;phi0&quot;</span><span class="p">:</span> <span class="n">phi0</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">phi</span> <span class="o">=</span> <span class="n">gradient_descent_with_line_search</span><span class="p">(</span><span class="n">phi0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Check the stability of the solution (i.e., check if solution is a max)</span>
        <span class="n">hess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hess</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">solution_is_max</span> <span class="o">=</span> <span class="n">hess</span> <span class="o">&lt;</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">solution_is_max</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found a maximum instead of minimum -&gt; perturbating the objective&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: this test might also be triggered by cups!&quot;</span><span class="p">)</span>
            <span class="c1"># Perform another gradient descent on the perturbed objective</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">gradient_descent_with_line_search</span><span class="p">(</span><span class="n">phi0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_pert</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Compute the load factor</span>
        <span class="n">load_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">load_factor</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">export_minimization_plots</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">phi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">load_factor</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">SIFs_controlled</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">SIFs_prescribed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">dir_name</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exports plots of the objective function and its gradient during minimization.</span>

<span class="sd">        This function generates and saves plots of the objective function, its perturbed</span>
<span class="sd">        version, and the gradient of the objective function during the minimization process.</span>
<span class="sd">        This function is mainly use to illustrate the minimization.</span>

<span class="sd">        Args:</span>
<span class="sd">            phi (float): Optimal crack propagation angle.</span>
<span class="sd">            load_factor (float): Optimal load factor.</span>
<span class="sd">            phi0 (float): Initial crack angle.</span>
<span class="sd">            SIFs_controlled (dict): Stress intensity factors for the controlled problem.</span>
<span class="sd">            SIFs_prescribed (dict): Stress intensity factors for the prescribed problem.</span>
<span class="sd">            s (float): Internal length associated with T-stress.</span>
<span class="sd">            t (int): Current time step.</span>
<span class="sd">            dir_name (Path): Directory to save the plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract the SIFs</span>
        <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
            <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
            <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
            <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
            <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># Construct the kwargs</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Ep&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Ep_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">),</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span>
            <span class="s2">&quot;KIc&quot;</span><span class="p">:</span> <span class="n">KIc</span><span class="p">,</span>
            <span class="s2">&quot;KIIc&quot;</span><span class="p">:</span> <span class="n">KIIc</span><span class="p">,</span>
            <span class="s2">&quot;Tc&quot;</span><span class="p">:</span> <span class="n">Tc</span><span class="p">,</span>
            <span class="s2">&quot;KIp&quot;</span><span class="p">:</span> <span class="n">KIp</span><span class="p">,</span>
            <span class="s2">&quot;KIIp&quot;</span><span class="p">:</span> <span class="n">KIIp</span><span class="p">,</span>
            <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">Tp</span><span class="p">,</span>
            <span class="s2">&quot;phi0&quot;</span><span class="p">:</span> <span class="n">phi0</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Display the objective function (and its minimum)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Bifurcation angle $\varphi$ (rad)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Load factor $\sqrt{\frac{G_c(\varphi)}{G^*(\varphi)}}$&quot;</span><span class="p">)</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">phi0</span> <span class="o">-</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">+</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span><span class="o">.</span><span class="n">__array__</span><span class="p">()</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phis</span><span class="p">]</span>
        <span class="n">objs_pert</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_pert</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phis</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Objective&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">objs_pert</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Perturbated objective&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">dir_name</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;objective_function_</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">08d</span><span class="si">}</span><span class="s2">.svg&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Bifurcation angle $\varphi$ (rad)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Derivative of the load factor&quot;</span><span class="p">)</span>
        <span class="n">grads</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="p">([</span><span class="n">phi_</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">phi_</span> <span class="ow">in</span> <span class="n">phis</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">grads</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">dir_name</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;residual_function_</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">08d</span><span class="si">}</span><span class="s2">.svg&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="gcrack.optimization_solvers.LoadFactorSolver.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Gc_func</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the LoadFactorSolver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="gcrack.gcrack.models.ElasticModel">ElasticModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elastic model used for the simulation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Gc_func</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The critical energy release rate function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xc</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position of the crack tip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">ElasticModel</span><span class="p">,</span> <span class="n">Gc_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">xc</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LoadFactorSolver.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (gcrack.models.ElasticModel): The elastic model used for the simulation.</span>
<span class="sd">        Gc_func (Callable): The critical energy release rate function.</span>
<span class="sd">        xc (List): Position of the crack tip.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Store the model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="c1"># Store the crack tip position</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span>
    <span class="c1"># Set the critical energy release rate function</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Gc</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">Gc_func</span><span class="p">)</span>
    <span class="c1"># Automatic differentiation of the objective function</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hess</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">hessian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">))</span>
    <span class="c1"># Automatic differentiation of the perturbed objective function</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grad_pert</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_pert</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hess_pert</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">hessian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_pert</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gcrack.optimization_solvers.LoadFactorSolver.export_minimization_plots" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_minimization_plots</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">load_factor</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">SIFs_controlled</span><span class="p">,</span> <span class="n">SIFs_prescribed</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports plots of the objective function and its gradient during minimization.</p>
<p>This function generates and saves plots of the objective function, its perturbed
version, and the gradient of the objective function during the minimization process.
This function is mainly use to illustrate the minimization.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>phi</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optimal crack propagation angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_factor</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optimal load factor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phi0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial crack angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>SIFs_controlled</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stress intensity factors for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>SIFs_prescribed</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stress intensity factors for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Internal length associated with T-stress.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current time step.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dir_name</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to save the plots.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">export_minimization_plots</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">phi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">load_factor</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">SIFs_controlled</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">SIFs_prescribed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">dir_name</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exports plots of the objective function and its gradient during minimization.</span>

<span class="sd">    This function generates and saves plots of the objective function, its perturbed</span>
<span class="sd">    version, and the gradient of the objective function during the minimization process.</span>
<span class="sd">    This function is mainly use to illustrate the minimization.</span>

<span class="sd">    Args:</span>
<span class="sd">        phi (float): Optimal crack propagation angle.</span>
<span class="sd">        load_factor (float): Optimal load factor.</span>
<span class="sd">        phi0 (float): Initial crack angle.</span>
<span class="sd">        SIFs_controlled (dict): Stress intensity factors for the controlled problem.</span>
<span class="sd">        SIFs_prescribed (dict): Stress intensity factors for the prescribed problem.</span>
<span class="sd">        s (float): Internal length associated with T-stress.</span>
<span class="sd">        t (int): Current time step.</span>
<span class="sd">        dir_name (Path): Directory to save the plots.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract the SIFs</span>
    <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
        <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
        <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
        <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
        <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="c1"># Construct the kwargs</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Ep&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Ep_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">),</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span>
        <span class="s2">&quot;KIc&quot;</span><span class="p">:</span> <span class="n">KIc</span><span class="p">,</span>
        <span class="s2">&quot;KIIc&quot;</span><span class="p">:</span> <span class="n">KIIc</span><span class="p">,</span>
        <span class="s2">&quot;Tc&quot;</span><span class="p">:</span> <span class="n">Tc</span><span class="p">,</span>
        <span class="s2">&quot;KIp&quot;</span><span class="p">:</span> <span class="n">KIp</span><span class="p">,</span>
        <span class="s2">&quot;KIIp&quot;</span><span class="p">:</span> <span class="n">KIIp</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">Tp</span><span class="p">,</span>
        <span class="s2">&quot;phi0&quot;</span><span class="p">:</span> <span class="n">phi0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Display the objective function (and its minimum)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Bifurcation angle $\varphi$ (rad)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Load factor $\sqrt{\frac{G_c(\varphi)}{G^*(\varphi)}}$&quot;</span><span class="p">)</span>
    <span class="n">phis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">phi0</span> <span class="o">-</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">+</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span><span class="o">.</span><span class="n">__array__</span><span class="p">()</span>
    <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phis</span><span class="p">]</span>
    <span class="n">objs_pert</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_pert</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phis</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Objective&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">objs_pert</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Perturbated objective&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">dir_name</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;objective_function_</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">08d</span><span class="si">}</span><span class="s2">.svg&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Bifurcation angle $\varphi$ (rad)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Derivative of the load factor&quot;</span><span class="p">)</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="p">([</span><span class="n">phi_</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">phi_</span> <span class="ow">in</span> <span class="n">phis</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">grads</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">dir_name</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;residual_function_</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">08d</span><span class="si">}</span><span class="s2">.svg&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gcrack.optimization_solvers.LoadFactorSolver.objective" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">objective</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">phi0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes the objective function for the GMERR criterion.</p>
<p>This function computes the objective function for the GMERR criterion, which is used to find the optimal crack propagation angle and load factor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimization variables (crack propagation angle).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Ep</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plane strain modulus.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Internal length associated with T-stress.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode I stress intensity factor for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIIc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode II stress intensity factor for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Tc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>T-stress for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode I stress intensity factor for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIIp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode II stress intensity factor for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Tp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>T-stress for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phi0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial crack angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value of the objective function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">Ep</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">Tp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the objective function for the GMERR criterion.</span>

<span class="sd">    This function computes the objective function for the GMERR criterion, which is used to find the optimal crack propagation angle and load factor.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray): The optimization variables (crack propagation angle).</span>
<span class="sd">        Ep (float): Plane strain modulus.</span>
<span class="sd">        s (float): Internal length associated with T-stress.</span>
<span class="sd">        KIc (float): Mode I stress intensity factor for the controlled problem.</span>
<span class="sd">        KIIc (float): Mode II stress intensity factor for the controlled problem.</span>
<span class="sd">        Tc (float): T-stress for the controlled problem.</span>
<span class="sd">        KIp (float): Mode I stress intensity factor for the prescribed problem.</span>
<span class="sd">        KIIp (float): Mode II stress intensity factor for the prescribed problem.</span>
<span class="sd">        Tp (float): T-stress for the prescribed problem.</span>
<span class="sd">        phi0 (float): Initial crack angle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The value of the objective function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE: The KIc (etc.) means controlled (not critical!)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Compute the G star</span>
    <span class="n">Gs_cc</span> <span class="o">=</span> <span class="n">G_star</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">Gs_cp</span> <span class="o">=</span> <span class="n">G_star_coupled</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">Gs_pp</span> <span class="o">=</span> <span class="n">G_star</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="c1"># Compute the Gc from phi</span>
    <span class="n">gc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gc</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="c1"># Compute and return the load factor</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">Gs_cp</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">Gs_cc</span> <span class="o">*</span> <span class="p">(</span><span class="n">Gs_pp</span> <span class="o">-</span> <span class="n">gc</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">Gs_cp</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Gs_cc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gcrack.optimization_solvers.LoadFactorSolver.objective_pert" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">objective_pert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">phi0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes the perturbed objective function for the GMERR criterion.</p>
<p>This function adds a small perturbation to the objective function to avoid
convergence to a maximum instead of a minimum.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimization variables (crack propagation angle).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Ep</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plane strain modulus.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Internal length associated with T-stress.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode I stress intensity factor for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIIc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode II stress intensity factor for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Tc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>T-stress for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode I stress intensity factor for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KIIp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mode II stress intensity factor for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Tp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>T-stress for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phi0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial crack angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value of the perturbed objective function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">objective_pert</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">Ep</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIIc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">KIIp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">Tp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the perturbed objective function for the GMERR criterion.</span>

<span class="sd">    This function adds a small perturbation to the objective function to avoid</span>
<span class="sd">    convergence to a maximum instead of a minimum.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray): The optimization variables (crack propagation angle).</span>
<span class="sd">        Ep (float): Plane strain modulus.</span>
<span class="sd">        s (float): Internal length associated with T-stress.</span>
<span class="sd">        KIc (float): Mode I stress intensity factor for the controlled problem.</span>
<span class="sd">        KIIc (float): Mode II stress intensity factor for the controlled problem.</span>
<span class="sd">        Tc (float): T-stress for the controlled problem.</span>
<span class="sd">        KIp (float): Mode I stress intensity factor for the prescribed problem.</span>
<span class="sd">        KIIp (float): Mode II stress intensity factor for the prescribed problem.</span>
<span class="sd">        Tp (float): T-stress for the prescribed problem.</span>
<span class="sd">        phi0 (float): Initial crack angle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The value of the perturbed objective function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">phi0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gcrack.optimization_solvers.LoadFactorSolver.solve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve</span><span class="p">(</span><span class="n">phi0</span><span class="p">,</span> <span class="n">SIFs_controlled</span><span class="p">,</span> <span class="n">SIFs_prescribed</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Solves for the optimal crack propagation angle and load factor.</p>
<p>This function uses gradient descent with line search to find the optimal
crack propagation angle and load factor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>phi0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial crack angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>SIFs_controlled</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stress intensity factors for the controlled problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>SIFs_prescribed</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stress intensity factors for the prescribed problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Internal length associated with T-stress.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[float, float]: The optimal crack propagation angle and load factor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">SIFs_controlled</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">SIFs_prescribed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solves for the optimal crack propagation angle and load factor.</span>

<span class="sd">    This function uses gradient descent with line search to find the optimal</span>
<span class="sd">    crack propagation angle and load factor.</span>

<span class="sd">    Args:</span>
<span class="sd">        phi0 (float): Initial crack angle.</span>
<span class="sd">        SIFs_controlled (dict): Stress intensity factors for the controlled problem.</span>
<span class="sd">        SIFs_prescribed (dict): Stress intensity factors for the prescribed problem.</span>
<span class="sd">        s (float): Internal length associated with T-stress.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[float, float]: The optimal crack propagation angle and load factor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">KIc</span><span class="p">,</span> <span class="n">KIIc</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
        <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
        <span class="n">SIFs_controlled</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">KIp</span><span class="p">,</span> <span class="n">KIIp</span><span class="p">,</span> <span class="n">Tp</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KI&quot;</span><span class="p">],</span>
        <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;KII&quot;</span><span class="p">],</span>
        <span class="n">SIFs_prescribed</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Perform the minimization</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Ep&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Ep_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">),</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span>
        <span class="s2">&quot;KIc&quot;</span><span class="p">:</span> <span class="n">KIc</span><span class="p">,</span>
        <span class="s2">&quot;KIIc&quot;</span><span class="p">:</span> <span class="n">KIIc</span><span class="p">,</span>
        <span class="s2">&quot;Tc&quot;</span><span class="p">:</span> <span class="n">Tc</span><span class="p">,</span>
        <span class="s2">&quot;KIp&quot;</span><span class="p">:</span> <span class="n">KIp</span><span class="p">,</span>
        <span class="s2">&quot;KIIp&quot;</span><span class="p">:</span> <span class="n">KIIp</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">Tp</span><span class="p">,</span>
        <span class="s2">&quot;phi0&quot;</span><span class="p">:</span> <span class="n">phi0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">phi</span> <span class="o">=</span> <span class="n">gradient_descent_with_line_search</span><span class="p">(</span><span class="n">phi0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Check the stability of the solution (i.e., check if solution is a max)</span>
    <span class="n">hess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hess</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">solution_is_max</span> <span class="o">=</span> <span class="n">hess</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">solution_is_max</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found a maximum instead of minimum -&gt; perturbating the objective&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: this test might also be triggered by cups!&quot;</span><span class="p">)</span>
        <span class="c1"># Perform another gradient descent on the perturbed objective</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">gradient_descent_with_line_search</span><span class="p">(</span><span class="n">phi0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_pert</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Compute the load factor</span>
    <span class="n">load_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">load_factor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="gcrack.optimization_solvers.gradient_descent_with_line_search" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gradient_descent_with_line_search</span><span class="p">(</span><span class="n">phi0</span><span class="p">,</span> <span class="n">gra</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Performs gradient descent with line search to minimize an objective function.</p>
<p>This function implements gradient descent with a custom line search to find the minimum
of an objective function. It is designed to handle discontinuities and "cups" in the
objective function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>phi0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess for the crack propagation angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gra</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The gradient of the objective function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tolerance for convergence.</p>
              </div>
            </td>
            <td>
                  <code>1e-06</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_iter</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the gradient function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimal crack propagation angle.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the gradient descent fails to converge.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/gcrack/optimization_solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gradient_descent_with_line_search</span><span class="p">(</span>
    <span class="n">phi0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">gra</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs gradient descent with line search to minimize an objective function.</span>

<span class="sd">    This function implements gradient descent with a custom line search to find the minimum</span>
<span class="sd">    of an objective function. It is designed to handle discontinuities and &quot;cups&quot; in the</span>
<span class="sd">    objective function.</span>

<span class="sd">    Args:</span>
<span class="sd">        phi0 (float): Initial guess for the crack propagation angle.</span>
<span class="sd">        gra (Callable): The gradient of the objective function.</span>
<span class="sd">        tol (float): Tolerance for convergence.</span>
<span class="sd">        max_iter (int): Maximum number of iterations.</span>
<span class="sd">        kwargs (dict): Additional arguments to pass to the gradient function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The optimal crack propagation angle.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the gradient descent fails to converge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Running the gradient descent with custom line search&quot;</span><span class="p">)</span>
    <span class="c1"># Initialization</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">phi0</span><span class="p">)</span>
    <span class="n">converged</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="c1"># Determine the direction</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="n">gra</span><span class="p">([</span><span class="n">phi</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Check if the direction is close to 0</span>
        <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># Set a null increment</span>
            <span class="n">dphi</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Set a null idx</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Apply line-search</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[(</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
            <span class="n">phis_test</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phi</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">])</span>
            <span class="c1"># Get the index associated with the first increase of the objective</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gra</span><span class="p">([</span><span class="n">phi_test</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">phi_test</span> <span class="ow">in</span> <span class="n">phis_test</span><span class="p">])</span>
            <span class="c1"># Create an array with the slope &quot;in the direction of minimization&quot;</span>
            <span class="n">slope</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="o">*</span> <span class="n">diff</span>
            <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">slope</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="c1"># If the slope is always negative, take the largest step</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">slope</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="c1"># If the slope is always positive, take no step</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If the slope increases after a decrease, then local minimum</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">slope</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="c1"># If the first grad is positive, we are at the solution</span>
                <span class="c1"># This case only occurs when the grad is discontinuous (cups)</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Calculate the increment</span>
            <span class="n">dphi</span> <span class="o">=</span> <span class="n">phis_test</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi</span>
        <span class="c1"># Update the solution</span>
        <span class="n">phi</span> <span class="o">+=</span> <span class="n">dphi</span>
        <span class="c1"># Generate an info message</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;      &quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Step: </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">06d</span><span class="si">}</span><span class="s2"> | &quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;phi: </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="si">:</span><span class="s2">+7.2f</span><span class="si">}</span><span class="s2"> | &quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;dphi: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">dphi</span><span class="p">)</span><span class="si">:</span><span class="s2">8.3g</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Check the convergence</span>
        <span class="n">converged</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dphi</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tol</span>
        <span class="k">if</span> <span class="n">converged</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      Converged&quot;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Clip the angle phi</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">phi0</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="n">phi0</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Check the convergence</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">converged</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;  Gradient descent failed to converge!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>